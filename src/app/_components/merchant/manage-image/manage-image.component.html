<div class="img-row"
     *ngIf="service.medias?.length > 0">
  <ng-container *ngFor="let img of service.medias; index as i">
    <div class="img-column"
         *ngIf="i % (service.medias.length < 16 ?Â 2 : 4) === 0 ">
      <ng-template [ngTemplateOutlet]="imageGrid"
                   [ngTemplateOutletContext]="{img: img}"></ng-template>
      <ng-template [ngTemplateOutlet]="imageGrid"
                   [ngTemplateOutletContext]="{img: service.medias[i + 1]}"
                   *ngIf="i + 1 < service.medias.length"></ng-template>
      <ng-template [ngTemplateOutlet]="imageGrid"
                   [ngTemplateOutletContext]="{img: service.medias[i + 2]}"
                   *ngIf="service.medias.length < 16 ? false : i + 2 < service.medias.length"></ng-template>
      <ng-template [ngTemplateOutlet]="imageGrid"
                   [ngTemplateOutletContext]="{img: service.medias[i + 3]}"
                   *ngIf="service.medias.length < 16 ? false : i + 3 < service.medias.length"></ng-template>
      <div class="container-img"
           *ngIf="service.loading && (service.medias.length < 16 ? i + 2 : i + 4) >= service.medias.length">
        <mat-spinner color="accent"></mat-spinner>
      </div>
    </div>
  </ng-container>
</div>

<ng-template #imageGrid
             let-img="img">
  <div class="border-shadow"
       [ngClass]="{'img-selected': img.id === service.selectedImg?.id}">
    <div class="container-img">
      <img [src]="img.url()"
           [alt]="img.description"
           (click)="service.selectImg(img)"
           class="img-fluid">
      <div class="text-block">
        <div class="d-flex align-items-center justify-content-between"
             *ngIf="img.id === service.selectedImg?.id">
          <app-text-edit #editor
                         [value]="img"
                         [service]="service"
                         [placeholder]="'description'"
                         [title]="false"
                         [field]="'description'"></app-text-edit>
          <button *ngIf="!editor.edit"
                  mat-button
                  [matTooltip]="vt.translate('delete.picture')"
                  (click)="service.delete(img)"
                  class="align-self-center">
            <mat-icon>delete</mat-icon>
          </button>
        </div>
        <p class="align-self-center"
           *ngIf="img.description">{{service.getTranslations(img)}}</p>
      </div>
    </div>
  </div>
</ng-template>
